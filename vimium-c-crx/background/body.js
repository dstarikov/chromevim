"use strict";var Settings,Backend,Utils={g:function(n,e){for(var r in e)r in n||(n[r]=e[r]);return n},y:function(){},x:/a?/,C:function(){return this.x.test("")},T:function(){return chrome.runtime.lastError},j:function(n,e,r){var t=r<n.length?n.charCodeAt(r-1):0;return n.substring(e,r+=8205===t?-1:t>=55296&&t<56320?1:0)},P:function(n,e,r){var t=e>0?n.charCodeAt(e):0;return n.substring(e+=8205===t?1:t>=56320&&t<=57343?-1:0,r)},z:function(n){function e(n){var e=n.charCodeAt(0);return 38===e?"&amp;":39===e?"&apos;":e<39?"&quot;":60===e?"&lt;":"&gt;"}var r=/["&'<>]/g;return this.z=function(n){return n.replace(r,e)},this.z(n)},$:function(n){var e=/\&(amp|gt|lt|nbsp);/g,r=Object.setPrototypeOf({amp:"&",gt:">",lt:"<",nbsp:" "},null),t=function(n,e){return r[e]};return this.$=function(n){return n.replace(e,t)},this.$(n)},V:function(n){return 58===n.charCodeAt(10)&&"javascript:"===n.substring(0,11).toLowerCase()},W:function(n){return(n=n.toLowerCase()).startsWith("about:")?"about:blank"!==n&&"about:blank/"!==n:n.startsWith("chrome://")?!n.startsWith("chrome://downloads"):!n.startsWith(Settings.hn.B)&&n.startsWith(f)},G:".\u4e2d\u4fe1.\u4e2d\u56fd.\u4e2d\u570b.\u4e2d\u6587\u7f51.\u4f01\u4e1a.\u4f5b\u5c71.\u4fe1\u606f.\u516c\u53f8.\u516c\u76ca.\u5546\u57ce.\u5546\u5e97.\u5546\u6807.\u5728\u7ebf.\u5a31\u4e50.\u5e7f\u4e1c.\u6211\u7231\u4f60.\u624b\u673a.\u62db\u8058.\u653f\u52a1.\u6e38\u620f.\u7f51\u5740.\u7f51\u5e97.\u7f51\u5e97.\u7f51\u7edc.\u8d2d\u7269.\u96c6\u56e2.\u9910\u5385",Y:["","",".ac.ad.ae.af.ag.ai.al.am.ao.aq.ar.as.at.au.aw.ax.az.ba.bb.bd.be.bf.bg.bh.bi.bj.bm.bn.bo.br.bs.bt.bv.bw.by.bz.ca.cc.cd.cf.cg.ch.ci.ck.cl.cm.cn.co.cr.cu.cv.cw.cx.cy.cz.de.dj.dk.dm.do.dz.ec.ee.eg.er.es.et.eu.fi.fj.fk.fm.fo.fr.ga.gb.gd.ge.gf.gg.gh.gi.gl.gm.gn.gp.gq.gr.gs.gt.gu.gw.gy.hk.hm.hn.hr.ht.hu.id.ie.il.im.in.io.iq.ir.is.it.je.jm.jo.jp.ke.kg.kh.ki.km.kn.kp.kr.kw.ky.kz.la.lb.lc.li.lk.lr.ls.lt.lu.lv.ly.ma.mc.md.me.mg.mh.mk.ml.mm.mn.mo.mp.mq.mr.ms.mt.mu.mv.mw.mx.my.mz.na.nc.ne.nf.ng.ni.nl.no.np.nr.nu.nz.om.pa.pe.pf.pg.ph.pk.pl.pm.pn.pr.ps.pt.pw.py.qa.re.ro.rs.ru.rw.sa.sb.sc.sd.se.sg.sh.si.sj.sk.sl.sm.sn.so.sr.st.su.sv.sx.sy.sz.tc.td.tf.tg.th.tj.tk.tl.tm.tn.to.tr.tt.tv.tw.tz.ua.ug.uk.us.uy.uz.va.vc.ve.vg.vi.vn.vu.wf.ws.ye.yt.za.zm.zw",".abc.art.bid.biz.cat.com.dev.edu.fun.gov.ink.int.kim.law.lol.ltd.men.mil.moe.mom.mtn.net.new.one.org.pro.pub.red.ren.run.tel.top.vip.win.xin.xxx.xyz",".aero.arpa.asia.auto.band.beer.chat.city.club.cool.coop.date.fund.game.gift.gold.guru.help.info.jobs.life.link.live.loan.love.mobi.name.news.pics.plus.post.shop.show.site.sohu.team.tech.wang.wiki.work.zone",".citic.click.email.games.group.local.onion.party.photo.press.rocks.space.store.today.trade.video.world",".center.design.lawyer.market.museum.online.social.studio.travel",".company.science.website",".engineer.software"],go:Object.create(null),No:/^([^:]+(:[^:]+)?@)?([^:]+|\[[^\]]+])(:\d{2,5})?$/,jo:/^\d{1,3}(?:\.\d{1,3}){3}$/,Po:/^\[[\da-f]{0,4}(?::[\da-f]{0,4}){1,5}(?:(?::[\da-f]{0,4}){1,2}|:\d{0,3}(?:\.\d{0,3}){3})]$/,Uo:/[\n\r]+[\t \xa0]*/g,zo:/\s+/g,vr:/\xa0/g,$o:/[^a-z]/,qo:/^[a-z][\+\-\.\da-z]+:\/\//,Fo:/[^.\da-z\-]|^-/,Vo:/["\[\]{}\u00ff-\uffff]|%(?![\dA-F]{2}|[\da-f]{2})/,Wo:/^"[^"]*"$|^'[^']*'$|^\u201c[^\u201d]*\u201d$/,Bo:/^[A-Za-z]:(?:[\\\/][^:*?"<>|]*)?$|^\/(?:Users|home|root)\/[^:*?"<>|]+$/,Go:/\\/g,Ko:0,Yo:function(n,e,r){var t,i,o,u,a,c,l,s=this;return n=n.trim(),s.Ko=0,s.V(n)?(ChromeVer<46&&n.indexOf("%",11)>0&&!s.Vo.test(n)&&(n=s.Jo(n)),n=n.replace(s.vr," "),s.C(),n):(t=-1,i=0,o=false,c=n.replace(s.Uo,"").replace(s.vr," "),n='"'===c[0]&&c.endsWith('"')?c.slice(1,-1):c,s.Bo.test(n)?(":"===n[1]&&(n=n[0].toUpperCase()+":/"+n.substring(3).replace(s.Go,"/")),s.C(),"file://"+("/"===n[0]?n:"/"+n)):n.startsWith("\\\\")&&n.length>3?((n=n.substring(2).replace(s.Go,"/")).lastIndexOf("/")<=0&&(n+="/"),s.C(),"file://"+n):((u=(n=c.toLowerCase()).indexOf(" ")+1||n.indexOf("\t")+1)>1&&(n=n.substring(0,u-1)),0===(u=n.indexOf(":"))?t=4:-1!==u&&s.qo.test(n)?n.startsWith("vimium:")?(t=3,(r|=0)<-1||!(n=c.substring(9))?c="vimium://"+c.substring(9):-1!==r&&(c=s.Zo(n,r))?"string"!==typeof c&&(t=5):c=s.Qo(n,false,r)):(-1===(a=n.indexOf("/",u+3))?n.length<c.length:n.charCodeAt(a+1)<33)?t=4:s.$o.test(n.substring(0,u))?t=(u=n.charCodeAt(u+3))>32&&47!==u?0:4:n.startsWith("file:")?t=0:n.startsWith("chrome:")?t=n.length<c.length&&-1===n.indexOf("/",9)?4:0:n=n.substring(u+3,-1!==a?a:void 0):(-1!==u&&n.lastIndexOf("/",u)<0&&(t=s.Xo(c.toLowerCase(),u,n.length%c.length)),i=2,a=c.length,-1===t&&n.startsWith("//")&&(n=n.substring(2),i=1,a-=2),-1!==t?"about:blank/"===n&&(c="about:blank"):(u=n.indexOf("/"))<=0?(0===u||n.length<a)&&(t=4):n.length>=a||n.charCodeAt(u+1)>32?(o=n.length>u+1,n=n.substring(0,u)):t=4),-1===t&&n.indexOf("%")>=0&&(n=Utils.Jo(n)).indexOf("/")>=0&&(t=4),-1===t&&n.startsWith(".")&&(n=n.substring(1)),-1!==t||((l=s.No.exec(n))?(n=l[3]).endsWith("]")?t=s.na(n,6)?i:4:n.endsWith("localhost")||s.na(n,4)||l[4]&&o?t=i:(u=n.lastIndexOf("."))<0||0===(t=s.ea(n.substring(u+1)))?(u<0&&"__proto__"===n&&(n="."+n),a=n.length-u-1,t=2!==i&&(u<0||a>=3&&a<=5)||s.ra(n,l[4])>0?i:4):t=n.length!==u+3&&1===t&&s.Fo.test(n)?4:2!==i||o?i:n.endsWith(".so")&&n.startsWith("lib")&&n.indexOf(".")===n.length-3?4:l[2]||l[4]||!l[1]||n.startsWith("ftp")?2:n.startsWith("mail")||n.indexOf(".mail")>0||(a=n.indexOf("."))===u?4:n.indexOf(".",++a)!==u?2:n.length===u+3&&1===t&&s.ea(n.substring(a,u),true)?4:2:(t=4,n.length===c.length&&s.na(n="["+n+"]",6)&&(c=n,t=2))),s.C(),s.Ko=t,0===t?c:4===t?s.ta(c.split(s.zo),e||"~",r):t<=2?(2===s.ra(n,l&&l[4])?"https:":"http:")+(2===t?"//":"")+c:c))},ra:function(n,e){var r=e&&this.go[n+e]||this.go[n];return r?r.https?2:1:0},Xo:function(n,e,r){var t=this,i="/"===n[e+1];switch(n.substring(0,e)){case"about":return i?4:r>0||n.indexOf("@",e)>0?-1:0;case"blob":case"view-source":return(n=n.substring(e+1)).startsWith("blob:")||n.startsWith("view-source:")?4:(t.Yo(n,null,-2),t.Ko<=2?0:4);case"data":return i?4:(e=n.indexOf(",",e))<0||r>0&&r<e?-1:0;case"file":return 0;case"filesystem":return n=n.substring(e+1),t.qo.test(n)?(t.Yo(n,null,-2),0===t.Ko&&/[^\/]\/(?:persistent|temporary)(?:\/|$)/.test(n)?0:4):4;case"magnet":return"?"!==n[e+1]?-1:0;case"mailto":return i?4:(e=n.indexOf("/",e))>0&&n.lastIndexOf("?",e)<0?-1:0;case"tel":return/\d/.test(n)?0:4;default:return i?4:-1}},ia:function(n){var e=n.startsWith("filesystem:")?11:n.startsWith("view-source:")?12:0;return e?n.substring(e):n},oa:function(n){var e,r,t=n.indexOf("\uff1a")+1||n.indexOf(":")+1;return t&&"/"!==n[t]?"link"!==(e=n.substring(0,t-1).trim().toLowerCase())&&"\u94fe\u63a5"!==e?n:((t=(r=n.substring(t).trim()).indexOf(" "))>0&&(r=r.substring(0,t)),",.;\u3002\uff0c\uff1b".indexOf(r[r.length-1])>=0&&(r=r.slice(0,-1)),r=this.Yo(r,null,-2),Utils.Ko<=2&&!r.startsWith("vimium:")?r:n):n},ea:function(n,e){return!e&&this.$o.test(n)?-1!==this.G.indexOf("."+n+".")?2:0:n.length<this.Y.length&&this.Y[n.length].indexOf(n)>0?1:0},ua:function(n){var e=n.toLowerCase().split("."),r=e.length;return[e,0===Utils.ea(e[r-1])?1:r>2&&2===e[r-1].length&&1===Utils.ea(e[r-2])?3:2]},na:function(n,e){return!!(6!==e&&this.jo.test(n)||4!==e&&this.Po.test(n))&&null!=this.aa("http://"+n)},aa:function(n){try{return new URL(n)}catch(n){}return null},ca:/\.[0-9A-Za-z]+$/,Qo:function(n,e,r){var t,i,o="",u="",a=n.trim();if(!a)return e?"":location.origin+"/pages/";if((t=a.indexOf(" ")+1)&&(u=a.substring(t).trim(),a=a.substring(0,t-1)),(t=a.indexOf("/")+1||a.search(this.la)+1)&&(o=a.substring(t-1).trim(),a=a.substring(0,t-1)),!this.ca.test(a))if(a=a.toLowerCase(),null!=(i=Settings.hn.sa[a]))i=a=i&&"/"!==i[0]&&"#"!==i[0]?i:Settings.hn.fa+i;else{if("newtab"===a)return Settings.J.newTabUrl_f;if("/"===a[0]||Settings.hn.ma.indexOf(a)>=0)a+=".html";else{if(1===r||-1===r)return"vimium://"+n.trim();a="show.html#!url vimium://"+a}}return e||i&&!(i.indexOf("://")<0)||(a=location.origin+("/"===a[0]?"":"/pages/")+a),o&&(a+=o),a+(u&&(a.indexOf("#")>0?" ":"#!")+u)},ha:0,da:/^[a-z][\da-z\-]*(?:\.[a-z][\da-z\-]*)*$/i,pa:/\.(?:css|html|js)$/i,va:/[\s+,\uff0c]+/g,Zo:function(n,e,r){var t,i,o,u,a,c=this;if((e|=0)<0||!(i=n=n.trim())||(t=n.indexOf(" "))<=0||!c.da.test(i=n.substring(0,t).toLowerCase())||c.pa.test(i))return null;if(!(n=n.substring(t+1).trimLeft()))return null;if(1===e)switch(i){case"sum":case"mul":n=n.replace(c.va,"sum"===i?" + ":" * "),i="e";break;case"avg":case"average":o=n.split(c.va),n="("+o.join(" + ")+") / "+o.length,i="e"}if(1===e)switch(i){case"e":case"exec":case"eval":case"expr":case"calc":case"m":case"math":return c.ba("MathParser").catch(function(){return null}).then(function(MathParser){return Utils.Wo.test(n)&&(n=n.slice(1,-1)),n=n.replace(/\uff0c/g," "),[Utils.ga(n,MathParser)||"","math",n]});case"error":return[n,"ERROR"]}else if(2===e)switch(i){case"status":case"state":return[n.toLowerCase(),"status"];case"url-copy":case"search-copy":case"search.copy":case"copy-url":if((a=c.Yo(n,null,1))instanceof Promise)return a.then(function(n){var e=n[0]||n[2]||"";return e=e instanceof Array?e.join(" "):e,Utils.wa(e),[e,"copy"]});a=5===c.Ko&&a instanceof Array?a[0]:a,n=a instanceof Array?a.join(" "):a;case"c":case"cp":case"copy":return Utils.wa(n),[n,"copy"]}switch(i){case"p":case"parse":case"decode":(i=n.split(" ",1)[0]).indexOf("/")<0&&i.toLowerCase().indexOf("%2f")<0?n=n.substring(i.length+1).trimLeft():i="~",o=[n=c._a(n)],n=c.Yo(n),4!==c.Ko&&(u=Backend.ya({u:n}))?""===u.u?o=[i]:(o=u.u.split(" ")).unshift(i):o=o[0].split(c.zo);break;case"u":case"url":case"search":o=c._a(n).split(c.zo);break;default:return null}return r?[o,"search"]:(t=c.ha++)>12?null:12===t?c.ta(o,"",0):t>0?c.ta(o,"",e):(a=c.ta(o,"",e),c.ha=0,a)},ga:function(n,e){var r=null;if((e=e||window.MathParser||{}).evaluate){try{r="function"===typeof(r=e.evaluate(n))?null:""+r}catch(n){}e.expression=""}return r},wa:function(n){},ba:function(n){var e=window[n];return e?Promise.resolve(e):window[n]=new Promise(function(e,r){var t=document.createElement("script");t.src=Settings.hn[n],t.onerror=function(){this.remove(),r("ImportError: "+n)},t.onload=function(){this.remove(),window[n]instanceof Promise?r("ImportError: "+n):e(window[n])},document.documentElement.appendChild(t)})},ka:/\$([sS])(?:\{([^}]*)})?/g,Sa:/([^\\]|^)%([sS])/g,xa:/\$([+-]?\d+)/g,ta:function(n,e,r){var t,i=this,o=Settings.J.searchEngineMap[e||n[0]];return o?(e||(e=n.shift()),t=i.Ca(n,o.url,o.blank)):t=n.join(" "),"~"!==e?i.Yo(t,null,r):(i.Ko=4,t)},Ca:function(n,e,r,t){var i,o=this,u=0;return e=0===n.length&&r?r:e.replace(o.ka,function(e,r,o,a){var c;return"S"===r?(c=n,r=" "):(c=i||(i=n.map(encodeURIComponent)),r="+"),0===c.length?"":(o=o&&-1!==o.indexOf("$")?o.replace(Utils.xa,function(n,e){var t=parseInt(e,10);if(!t)return c.join(r);if(t<0)t+=c.length+1;else if("+"===e[0])return c.slice(t-1).join(r);return c[t-1]||""}):c.join(null!=o?o:r),null!=t&&(t.push(a+=u,a+o.length),u+=o.length-e.length),o)}),o.C(),null==t?e:{url:e,indexes:t}},Jo:function(n,e){if(!n)return"";try{n=(e||decodeURIComponent)(n)}catch(n){}return n},Ra:/%(?:3[aA]|2[fF])/,_a:function(n){return n.indexOf("://")<0&&this.Ra.test(n)?this.Jo(n).trim():n},Ta:/\u3002/g,Ia:function(n){var e,r,t=(n.indexOf("\u3002")<0?0:1)+(n.indexOf("\uff1a")<0?0:2);return 0===t?n:(e=n.indexOf("//"),(e=n.indexOf("/",e>=0?e+2:0))>=0&&e<4?n:(r=n.substring(0,e>0?e:n.length),1&t&&(r=r.replace(this.Ta,".")),2&t&&(r=r.replace("\uff1a",":").replace("\uff1a",":")),e>0&&(r+=n.substring(e)),this.Yo(r,null,-2),this.Ko<=2?r:n))},Na:/\.(?:bmp|gif|icon?|jpe?g|png|tiff?|webp)$/i,ja:function(n){return this.Na.test(n)?this.Qo("show image "+n,false,0):n},Ma:function(n){var e,r,t=n.indexOf(":"),i=t;if(t<=0)return n;if("://"===n.substring(t,t+3))if((t=n.indexOf("/",t+3))<0)t=i,i=-1;else if(7===t&&"file"===n.substring(0,4).toLowerCase())return"file:///"+((t=":"===n[9]?3:0)?n[8].toUpperCase()+":/":"")+n.substring(t+8);return r=(e=n.substring(0,t)).toLowerCase(),-1===i&&/^(file|ftp|https?|rt[ms]p|wss?)$/.test(e)&&(n+="/"),e!==r?r+n.substring(t):n},Pa:function(n,e){var r,t,i,o,u,a,c,l,s,f,m,h,d,p=this,v=/[^\\]\//,b=[],g=/\\\s/g,w=/\s/,_=/\\s/g,y=/\\:/g,k=/\\%/g,S=/\sre=/i,x=/\sblank=/i,C=/%24([sS])/g,R=p.ka,T=function(n){return!!((n=n.trim())&&"__proto__"!==n&&n.length<51)&&(e[n]=u,true)};for(c=0,l=n.replace(/\\\n/g,"").split("\n");c<l.length;c++)if((s=(s=l[c]).trim())&&s.charCodeAt(0)>35){a=0;do{a=s.indexOf(":",a+1)}while(92===s.charCodeAt(a-1));a<=0||!(o=s.substring(0,a).trimRight())||(r=o.replace(y,":").split("|"),(s=s.substring(a+1).trimLeft())&&(f="",(a=(o=s.replace(g,"\\s")).search(w))>0?(n=s.substring(a),s=o.substring(0,a),(a=n.search(x))>=0&&(m=n.substring(a+7).search(w),f=n.substring(a+7,(m=m>0?a+7+m:0)||n.length),n=n.substring(0,a)+(m?n.substring(m):"")),a=n.search(S)):(s=o,n=""),s=s.replace(_," ").trim().replace(p.Sa,"$1$$$2").replace(k,"%"),u={name:"",blank:f,url:s},0!==(r=r.filter(T)).length&&(-1===a?(R.lastIndex=0,(h=R.exec(s))&&(a=h.index+1)&&((o=h[2])?s=s.replace(R,"$$$1"):o="s"===h[1]?"+":" ",s=p.Yo(s,null,-1),p.Ko>2?a=(s=s.replace(C,"$$$1")).search(R)+1:0!==p.Ko&&(a+=2===p.Ko?7:5),(t=p.Ua(s.toLowerCase(),a))&&(o.indexOf("$")>=0?(o=o.replace(p.xa,"(.*)"),i=new RegExp("^"+o,p.za.test(o)?"i":"")):i=o.trim()||" ",b.push({prefix:t.prefix,matcher:t.matcher,name:r[0].trimRight(),delimiter:i})))):47===n.charCodeAt(a+4)?(o=a>1?n.substring(1,a).trim():"",a=(n=n.substring(a+5)).search(v)+1,s=n.substring(0,a),a=(n=n.substring(a+1)).search(w),(d=p.Ea(s,a>=0?n.substring(0,a):n))&&(o=p.$a(o),b.push({prefix:o,matcher:d,name:r[0].trimRight(),delimiter:u.url.lastIndexOf("$S")>=0?" ":"+"})),n=a>=0?n.substring(a+1):""):n=n.substring(a+4),n=n.trimLeft(),u.name=n?p.Jo(n):r[r.length-1].trimLeft())))}return b},Oa:/[$()*+.?\[\\\]\^{|}]/g,Da:/\\\+|%20| /g,la:/[#?]/,za:/[a-z]/i,Ua:function(n,e){var r,t,i,o,u=this;return u.qo.test(n)?(r=n.substring(0,e-1),(e=Math.max(r.lastIndexOf("?"),r.lastIndexOf("#"))+1)?(i=t=r.substring(e),r=r.substring(0,r.search(u.la)),(o=t.lastIndexOf("&")+1)&&(i=t.substring(o)),i&&i.indexOf("=")>=1?t="[#&?]":(i=t,t="#"===n[e-1]?"#":i?"[#?]":"\\?"),n="([^#&?]*)"):(t="^([^#?]*)",(i=n.substring(r.length+2))&&(e=i.search(u.la)+1)&&(i=i.substring(0,e-1)),n=""),i=i&&i.replace(u.Oa,"\\$&").replace(u.Da,"(?:\\+|%20| )"),{prefix:r=u.$a(r),matcher:new RegExp(t+i+n,u.za.test(i)?"i":"")}):null},Aa:function(n){return(n=n.substring(0,8).toLowerCase()).startsWith("http://")?7:"https://"===n?8:0},$a:function(n){var e=n.substring(0,9).toLowerCase();return this.Aa(e)?n=n.substring(58===n.charCodeAt(4)?7:8):"vimium://"===e&&(n=this.Qo(n.substring(9),false,-1)),n},Ea:function(n,e,r){try{return new RegExp(n,e)}catch(t){false===r||console.log("%c/%s/%s","color:#c41a16",n,e,"is not a valid regexp.")}return null},Ha:/<(?!<)(?:.-){0,4}.\w*?>|./g,qa:/<(?!<)((?:[acm]-){0,3})([^a-z0-9][\dA-Z]*)>/g,La:function(n,e,r){var t=r.toLowerCase();return r!==t?"<"+e+"s-"+t+">":n},Fa:function(n){return n&&n.replace(this.qa,this.La)},Va:function(n,e,r){var t,i=null;return r||(r=a.Wa[n]),t=r.length<5?null:Object.setPrototypeOf(r[4],null),e?("count"in e&&(e.count=1===r[1]?1:(parseFloat(e.count)||1)*(t&&t.count||1)),(e.$desc||e.$key)&&(i={key:e.$key||"",desc:e.$desc||""},delete e.$key,delete e.$desc),t&&Utils.g(e,t)):e=t,{alias:r[3],background:r[2],command:n,help:i,options:e,repeat:r[1]}},Ba:function(){return null},Ga:function(){},Ka:function(n){return n.toLowerCase()!==n}},OnOther=1,ChromeVer=0|(navigator.appVersion.match(/\bChrom(?:e|ium)\/(\d+)/)||[0,999])[1],f="chrome";"".startsWith||(String.prototype.startsWith=function(n){return this.length>=n.length&&0===this.lastIndexOf(n,0)},"".endsWith||(String.prototype.endsWith=function(n){var e=this.length-n.length;return e>=0&&this.indexOf(n,e)===e})),Settings={J:Object.create(null),Ya:{Ja:null,Za:0,Qa:null},Xa:{__proto__:null,nc:1,Ee:ChromeVer,so:false,Ot:false},ec:Object.create(null),rc:null,tc:localStorage,ic:function(n,e){var r,t,i;return n in this.J?this.J[n]:(r=this.oc[n],i=null==(t=this.tc.getItem(n))?r:"string"===typeof r?t:false===r||true===r?"true"===t:JSON.parse(t),e&&(this.J[n]=i),i)},uc:function(n,e){var r,t,i=this;if(i.J[n]=e,n in i.ac||(e===(r=i.oc[n])?(i.tc.removeItem(n),i.cc(n,null)):(i.tc.setItem(n,"string"===typeof r?e:JSON.stringify(e)),i.cc(n,e)),n in i.Xa&&(i.Xa[n]=e)),t=i.lc[n])return t.call(i,e,n)},sc:function(n,e){return this.lc[n].call(this,void 0!==e?e:this.ic(n),n)},fc:function(n){var e,r,t,i=Backend.mc();for(e in i)for(t=(r=i[+e]).length;0<--t;)r[t].postMessage(n)},hc:function(n){var e,r,t=n?n.split(/\/\*\s?#!?([A-Za-z]+)\s?\*\//g):[""],i={ui:t[0].trim()};for(e=1;e<t.length;e+=2)i["vomnibar"===(r=t[e].toLowerCase())?"omni":r]=t[e+1].trim();return i},lc:{__proto__:null,extWhiteList:function(n){var e,r,t,i,o=this.rc,u=this.rc=Object.create(null);if(o)for(e in o)false===o[e]&&(u[e]=false);if(n)for(t=(r=n.split("\n")).length,i=/^[\da-z]/i;0<=--t;)(n=r[t].trim())&&i.test(n)&&(u[n]=true)},grabBackFocus:function(n){this.Xa.so=n},newTabUrl:function(n){return n=/^\/?pages\/[a-z]+.html\b/i.test(n)?chrome.runtime.getURL(n):Utils.Yo(n),this.uc("newTabUrl_f",n)},searchEngines:function(){return this.uc("searchEngineMap",Object.create(null))},searchEngineMap:function(n){var e,r=this;return"searchKeywords"in r.J&&r.uc("searchKeywords",null),e=Utils.Pa("~:"+r.ic("searchUrl")+"\n"+r.ic("searchEngines"),n),r.uc("searchEngineRules",e)},searchUrl:function(n){var e,r=this.J;if(n)Utils.Pa("~:"+n,r.searchEngineMap);else if(e={"~":{name:"~",blank:"",url:this.ic("searchUrl").split(" ",1)[0]}},r.searchEngineMap=e,r.searchEngineRules=[],n=this.ic("newTabUrl_f",true))return this.lc.newTabUrl_f(n);return this.sc("newTabUrl")},baseCSS:function(n){var e,r,t,i,o,u,a=this,c=a.hn.dc,l=ChromeVer,s=c.substring(c.indexOf(",")+1),f=s.indexOf("a")>=0;return l<54&&(n=n.replace(/user-select\b/g,"-webkit-$&")),e=n.lastIndexOf("/*#find*/"),r=n.substring(e+10),n=n.substring(0,e-1),f?(t=n.indexOf("all:"),i=n.lastIndexOf("{",t),o=l>=53?n.indexOf(";",t):n.length,n=n.substring(0,i+1)+n.substring(t,o+1)+n.substring(n.indexOf("\n",o)+1||n.length)):n=n.replace(/all:\s?\w+;?\n?/,""),l>=65&&!0?(t=n.indexOf("display:"),i=n.lastIndexOf("{",t),n=n.substring(0,i+1)+n.substring(t)):n=n.replace("contents","block"),l<73&&(n=n.replace("3px 5px","3px 7px")),ChromeVer<62&&(n=n.replace(/#[0-9a-z]{8}/gi,function(n){var e=parseInt(n.slice(1),16);return"rgba("+(e>>>24)+","+(e>>16&255)+","+(e>>8&255)+","+((255&e)/255+"").slice(0,4)+")"})),n=c+n.length+"\n"+n,(u=a.hc(a.ic("userDefinedCss"))).ui&&(n+="\n"+u.ui),l<48&&(n=n.replace(/\b(border(?:-\w*-?width)?: ?)(0\.5px|\S+.\/\*!DPI\*\/)/g,"$11px /*!DPI*/")),a.tc.setItem("findCSS",r.length+"\n"+r+(u.find?"\n"+u.find:"")),a.tc.setItem("omniCSS",u.omni||""),a.uc("innerCSS",n)},userDefinedCss:function(n){var e,r,t,i,o,u,a,c,l,s,f,m,h,d=this,p=d.tc.getItem("innerCSS"),v=p.indexOf("\n");for(a in p=p.substring(0,v+1+ +p.substring(0,v).split(",")[2]),r=(e=d.hc(n)).ui?p+"\n"+e.ui:p,v=(p=d.tc.getItem("findCSS")).indexOf("\n"),p=p.slice(0,v+1+ +p.substring(0,v)),d.tc.setItem("findCSS",(t=e.find)?p+"\n"+t:p),d.tc.setItem("omniCSS",e.omni||""),d.uc("innerCSS",r),r=(i=d.J).innerCSS,o=Backend.mc(),u={N:12,S:r,f:i.pc},o)for(l=(c=o[+a]).length;0<--l;)4&(s=c[l].s).f&&(c[l].postMessage(u),s.f|=32);for(f={N:12,S:i.vc},m=0,h=Backend.mc(-3);m<h.length;m++)h[m].postMessage(f)},innerCSS:function(n){var e,r,t=this,i=t.J,o=t.tc.getItem("findCSS"),u=t.tc.getItem("omniCSS");o&&null!=u?(e=(o=o.substring(o.indexOf("\n")+1)).indexOf("\n")+1,r=o.indexOf("\n",e),i.innerCSS=n.substring(n.indexOf("\n")+1),i.pc=[o.substring(0,e-1),o.substring(e,r),o.substring(r+1)],i.vc=u):Settings.bc("baseCSS")},vomnibarPage:function(n){var e=this,r=localStorage.getItem("vomnibarPage_f");!r||n?((n=n||e.ic("vomnibarPage"))===e.oc.vomnibarPage?n=e.hn.gc:n.startsWith("front/")?n=chrome.runtime.getURL(n):(n=Utils.Yo(n),n=Utils.Ma(n),n=ChromeVer<50&&!n.startsWith(f)?e.hn.gc:n.replace(":version",""+parseFloat(e.hn.wc))),e.uc("vomnibarPage_f",n)):e.J.vomnibarPage_f=r},vomnibarOptions:function(n){var e,r,t,i,o,u,a,c,l,s=this,f=s.oc.vomnibarOptions,m=true;for(n!==f&&n&&"object"===typeof n&&(e=f.maxMatches,r=f.queryInterval,t=Math.max(3,Math.min(0|n.maxMatches||e,25)),i=+n.queryInterval,o=((n.styles||"")+"").trim(),u=Math.max(0,Math.min(i>=0?i:r,1200)),(m=e===t&&r===u&&!o)||(n.maxMatches=t,n.queryInterval=u,n.styles=o)),s.J.vomnibarOptions=n=m?f:n,a={N:47,o:n},c=0,l=Backend.mc(-3);c<l.length;c++)l[c].postMessage(a)}},bc:function(n,e){var r,t;if(e&&n in this.J)return e(),null;if(!(r=this.hn[n]))throw Error("unknown file: "+n);return(t=new XMLHttpRequest).open("GET","/front/"+r,true),t.responseType="text",t.onload=function(){var r=this.responseText;"baseCSS"===n?Settings.sc(n,r):"words"===n?Settings.hn.words=r.replace(/[\n\r]/g,""):Settings.uc(n,r),e&&setTimeout(e,0)},t.send(),t},oc:{__proto__:null,deepHints:false,dialogMode:false,exclusionListenHash:true,exclusionOnlyFirstMatch:false,exclusionRules:[{pattern:"^https?://mail.google.com/",passKeys:""}],extWhiteList:"# modified { Vomnibar Page, X New Tab, PDF Viewer }\nekohaelnhhdhbccgefjmjpdjoijhojgd\nhdnehngglnbnehkfcidabjckinphnief\nhlaahnfmlljbnceljomccmmdafjmlmdk\nnacjakoppgmdcpemlfnfegmlhipddanj",findModeRawQueryList:"",focusNewTabContent:true,grabBackFocus:false,hideHud:false,innerCSS:"",keyboard:[560,33],keyMappings:"",linkHintCharacters:"sadjklewcmpgh",localeEncoding:"gbk",newTabUrl:"",newTabUrl_f:"",nextPatterns:"\u4e0b\u9875,\u4e0b\u4e00\u9875,\u4e0b\u4e00\u7ae0,\u540e\u4e00\u9875,next,more,newer,>,\u203a,\u2192,\xbb,\u226b,>>",previousPatterns:"\u4e0a\u9875,\u4e0a\u4e00\u9875,\u4e0a\u4e00\u7ae0,\u524d\u4e00\u9875,prev,previous,back,older,<,\u2039,\u2190,\xab,\u226a,<<",regexFindMode:false,scrollStepSize:100,searchUrl:navigator.language.startsWith("zh")?"https://www.baidu.com/s?ie=utf-8&wd=%s \u767e\u5ea6":"https://www.google.com/search?q=%s Google",searchEngines:"b|ba|baidu: https://www.baidu.com/s?ie=utf-8&wd=%s Baidu\nbi|bing: https://www.bing.com/search?q=%s Bing\ng|go|gg|google: https://www.google.com/search?q=%s Google\njs\\:|Js: javascript:\\ $S; JavaScript\nw|wiki:\\\n  https://www.wikipedia.org/w/index.php?search=%s Wikipedia\nv.m|v\\:math: vimium://math\\ $S re= Calculate\n\n# More examples.\n#\n# (Vimium C supports search completion Google, Wikipedia,\n# and so on, as above, and for these.)\n#\n# l: https://www.google.com/search?q=%s&btnI I'm feeling lucky\n# y: https://www.youtube.com/results?search_query=%s Youtube\n# gm: https://www.google.com/maps?q=%s Google maps\n# d: https://duckduckgo.com/?q=%s DuckDuckGo\n# az: https://www.amazon.com/s/?field-keywords=%s Amazon\n# qw: https://www.qwant.com/?q=%s Qwant",searchEngineMap:{},showActionIcon:true,showAdvancedCommands:false,showAdvancedOptions:false,smoothScroll:true,vomnibarOptions:{maxMatches:10,queryInterval:500,styles:""},userDefinedCss:"",vimSync:null,vomnibarPage:"front/vomnibar.html",vomnibarPage_f:"",phraseBlacklist:""},ac:{__proto__:null,baseCSS:1,exclusionTemplate:1,helpDialog:1,searchEngineMap:1,searchEngineRules:1,searchKeywords:1},_c:{__proto__:null,showAdvancedCommands:1},yc:[{19:"/icons/enabled_19.png",38:"/icons/enabled_38.png"},{19:"/icons/partial_19.png",38:"/icons/partial_38.png"},{19:"/icons/disabled_19.png",38:"/icons/disabled_38.png"}],kc:["deepHints","keyboard","linkHintCharacters","regexFindMode","scrollStepSize","smoothScroll"],cc:Utils.y,hn:{Sc:true,xc:0,B:"chrome-search://local-ntp/local-ntp.html",Cc:false,Rc:null,wc:"",Tc:"",GitVer:"ee59c89",dc:"",ma:["blank","newtab","options","show"],MathParser:"/lib/math_parser.js",HelpDialog:"/background/help_dialog.js",Commands:"/background/commands.js",Exclusions:"/background/exclusions.js",Ic:"content/injected_end.js",Nc:"pages/options.html#!newTabUrl",jc:"pages/options.html",Mc:"browser",baseCSS:"vimium.min.css",exclusionTemplate:"exclusions.html",helpDialog:"help_dialog.html",words:"words.txt",Pc:"lib/polyfill.js",fa:"https://github.com/gdh1995/vimium-c",sa:{about:"",changelog:"#release-notes",help:"/wiki",home:"",license:"/blob/master/LICENSE.txt",permissions:"/blob/master/PRIVACY-POLICY.md#permissions-required",policy:"/blob/master/PRIVACY-POLICY.md",popup:"options.html",privacy:"/blob/master/PRIVACY-POLICY.md#privacy-policy",readme:"#readme",settings:"options.html",wiki:"/wiki",__proto__:null},Uc:null,zc:"pages/show.html",gc:"",Ec:"/front/vomnibar.js",$c:""}},chrome.runtime.getPlatformInfo(function(n){var e=n.os.toLowerCase(),r=chrome.runtime.PlatformOs||{MAC:"mac",WIN:"win"};Settings.hn.Mc=e,Settings.Xa.Ot=e===r.MAC||e===r.WIN&&0}),ChromeVer<59&&!0&&1?Settings.bc("words"):Settings.hn.words="",(function(){function n(n){return(47===n.charCodeAt(0)?o:n.startsWith(u)?"":u)+n}var e,r,t,i=chrome.runtime.getManifest(),o=location.origin,u=o+"/",a=i.content_scripts[0].js,c=Settings,l=c.hn,s=c.oc,f=c.kc,m=c.Xa,h="about:newtab",d="chrome://newtab",p=c.ec;for(s.newTabUrl=l.B,p[h]=p[h+"/"]=2,p[d]=p[d+"/"]=2,p[n(i.chrome_url_overrides.newtab)]=2,l.Uc=Object.keys(i.commands||{}).map(function(n){return"quickNext"===n?"nextTab":n}),l.wc=i.version,l.Tc=i.version_name||i.version,l.jc=n(i.options_page||l.jc),l.Sc=null!=i.permissions&&i.permissions.indexOf("clipboardRead")>=0,l.zc=n(l.zc),l.gc=n(s.vomnibarPage),l.$c=n(l.Ec),l.fa=i.homepage_url||l.fa,a.push(l.Ic),ChromeVer<44&&"startsWith"!=="".startsWith.name&&a.unshift(l.Pc),l.Rc=a.map(n),m.so=c.ic("grabBackFocus"),e=f.length;0<=--e;)m[r=f[e]]=c.ic(r);localStorage.length<=0&&c.uc("newTabUrl",l.Nc),l.dc=l.wc+","+ChromeVer+(ChromeVer>41&&!0?"a":"")+",",(t=localStorage.getItem("innerCSS"))&&t.startsWith(l.dc)?c.sc("innerCSS",t):(localStorage.removeItem("vomnibarPage_f"),c.bc("baseCSS"))})(),(function(){function n(n,e){var r,t=n.url;return t?(r=Settings.ec[t])&&2===r&&(n.url=Settings.J.newTabUrl_f):delete n.url,chrome.tabs.create(n,e)}function t(e,r){var t=e.windowId,i=null!=e.index;if(n(e,e.active?function(n){n&&n.windowId!==t&&A(n)}:null),!(r<2)){e.active=false;do{i&&++e.index,chrome.tabs.create(e)}while(--r>1)}}function i(n,e){var r,t,i;return null==n&&(n="unknown_sender"),null!=(t=(r=Settings.rc)[n])?t:e===Settings.J.vomnibarPage_f||(i="background-color:#fffbe5",console.log("%cReceive message from an extension/sender not in the white list: %c%s",i,i+";color:red",n),r[n]=false)}function o(n,e){for(var r=n.length;0<--r;)if(n[r].active)return n[r];return n[0]}function u(n,e){return"before"===e?n.index:"start"===e?0:"end"!==e?n.index+1:void 0}function l(n,e,r){false===n.focused?"minimized"!==e&&(e="normal"):"minimized"===e&&(e="normal"),e&&ChromeVer>=44&&(n.state=e,e="");var t=false!==n.focused;n.focused=true,chrome.windows.create(n,e||!t?function(n){if(r&&r(n),n){var i=t?{}:{focused:false};e&&(i.state=e),chrome.windows.update(n.id,i)}}:r||null)}function s(n,e,r){var t="number"===typeof n,i={type:"normal",focused:false,incognito:e,state:"minimized",tabId:t?n:void 0,url:t?void 0:n};ChromeVer<44&&(i.state=void 0,i.left=i.top=0,i.width=i.height=50),chrome.windows.create(i,r)}function m(e,r,t){if(t){if(t.length>0&&t[0].incognito&&Utils.W(e))return n({url:e}),void Utils.C()}else if(Utils.W(e)&&true!==r)return void fn(function(n){return m(e,true,n)});var i={url:e},o=ln;t?chrome.tabs.update(t[0].id,i,o):chrome.tabs.update(i,o),Utils.C()}function h(n){if(n instanceof Promise)n.then(h);else switch(Utils.C(),n[1]){case"copy":return Backend.Oc(n[0],true);case"status":return Backend.Dc(n[0])}}function p(){ChromeVer>=37?Backend.Ac("control tab sessions"):Backend.Oc("Vimium C can not control tab sessions before Chrome 37")}function g(n,e){var r,t,i,o=Utils.aa(n),u=o?o.hostname:"";if(u&&/git\b|\bgit/i.test(u)&&/^[\w\-]+(\.\w+)?$/.test(u)&&((r=e.split("/"))[t=r.length-1]||(t--,r.pop()),i=r[t],"github.com"===u)){if(3===t)return"pull"===i||"milestone"===i?e+"s":"tree"===i?r.slice(0,3).join("/"):null;if(4===t&&"releases"===r[3]&&("tag"===r[4]||"edit"===r[4]))return r.slice(0,4).join("/");if(t>3)return"blob"===r[3]?(r[3]="tree",r.join("/")):null}}function w(n,e){var r=n.s,t=r.f;return 128&t||(r.f=t|=128|(r.u===Settings.J.vomnibarPage_f||r.u===Settings.hn.gc?256:0)),!(256&t)&&(e||512&t||(console.warn("Receive a request from %can unsafe source page%c (should be vomnibar) :\n %s @ tab %o","color:red","color:auto",r.u,r.t),r.f=512|t),true)}function _(n,e,r,t,i){var o,u,a,c,l,s,f,m=this.s.u,h=2===n?2:0;if(1===n&&ChromeVer>=58&&(m=m.substring(0,m.indexOf("/",m.indexOf("://")+3)+1),o=cn,null!=(u=un>=0?k(un,0):null)&&(u.s.u.startsWith(m)?h=1:un=-1),!h))for(a in o){for(l=1,s=(c=o[+a]).length;l<s;l++)if(0===(f=c[l].s).i){f.u.startsWith(m)&&(h=1,un=+a);break}if(h)break}y(this,{N:43,a:r,m:t,l:e,i:h,t:i}),Utils.C()}function y(n,e){try{return n.postMessage(e),1}catch(n){return 0}}function k(n,e){var r,t,i=cn[n];if(!i)return null;for(r=1,t=i.length;r<t;r++)if(i[r].s.i===e)return i[r];return null}function S(n,e,r,t){var i,o,u=nn;return t&&(u+=u>0?t:-t),o=u>0,(i=n+u)<=e&&i>-2?o?[n,i]:[i+1,n+1]:!Q.limited&&Math.abs(u)<2*(r||e)?Math.abs(u)<e?o?[e-u,e]:[0,-u]:[0,e]:o?[n,e]:[0,n+1]}function x(n,e){var r=a.Wa[n][0];return r=r.replace(/ \(use .*|&nbsp\(.*|<br\/>/,""),window.confirm("You have asked Vimium C to perform "+e+" repeats of the command:\n      "+Utils.$(r)+"\n\nAre you sure you want to continue?")}function C(n,e){if(null==Exclusions||Exclusions.Hc.length<=0||!(e||Settings.ic("exclusionListenHash",true)))return n.N=3,void X.postMessage(n);n.u=X.s.u,_n[n.H](n,X)}function R(n){var e=n.s;return 4&e.f?null:(e.f|=6,Settings.J.innerCSS)}function T(n,e,r,t,i){return r="-"!==r?parseInt(r,10)||1:-1,e&&"object"===typeof e||(e=null),i=+i||0,F(Utils.Va(n,e),r,i,t)}function I(n){var e=cn[n?n.s.t:d.ho];return e?e[0]:null}function N(n,e,r,i,o){var a,c=o.filter(function(n){return n.id===i.windowId})[0],s=null!=c&&c.incognito;return!r.window&&(s||(o=o.filter(function(n){return n.incognito&&"normal"===n.type})).length>0)?(a={url:n,active:e,windowId:s?i.windowId:o[o.length-1].id},s&&(a.index=u(i,r.position),r.opener&&(a.openerTabId=i.id)),t(a,nn),!s&&e?A(a):void 0):l({url:n,incognito:true,focused:e},c&&"normal"===c.type?c.state:"")}function j(n,e,r){if(Q.url||Q.urls)return gn[14](r),ln();var i=null;if(r){if(r.length>0)i=r[0];else if(d.ho>=0)return chrome.tabs.get(d.ho,function(r){j(n,e,r&&[r])}),ln()}else;return i?(i.incognito&&e&&(n=""),t({url:n,active:i.active,windowId:i.windowId,index:u(i,Q.position)},nn)):(t({url:n,active:true},nn),ln())}function M(n,e,r){var t,i,o;return"string"===typeof n&&((t=Q.url_mask)&&(n=n&&n.replace(t+"",r.length>0?r[0].url:"")),(t=Q.id_mask||Q.id_mark||Q.id_marker)&&(n=n&&n.replace(t+"",chrome.runtime.id)),9!==e&&(n=Utils.Yo(n+"",(Q.keyword||"")+"",e))),i=null==Q.reuse?-1:0|Q.reuse,o=Q,Q=null,Utils.C(),"string"!==typeof n?h(n):pn[0](n,i,o)?void 0:Utils.V(n)?z(n):1===i?_n[19]({u:n}):0===i?m(n):r?U(n,i,o,r):void fn(U.bind(null,n,i,o))}function P(n,e){if(null===e)return Backend.Ac("read clipboard");if(!(e=e.trim()))return Backend.Oc("No text copied!");if(Utils.Wo.test(e))e=e.slice(1,-1);else{var r=Q.keyword;r&&"~"!==r||(e=Utils.oa(e))}return M(e,2,n)}function U(n,e,r,i){var o=i[0],a=!!o&&o.incognito,c=r.incognito,s=-2!==e,f=r.window;if(Utils.W(n))(a||2===d.qc)&&(f=true);else if(a){if(false!==c)return N(n,s,r,o,[{id:o.windowId,incognito:true}]);f=true}else if(c)return void chrome.windows.getAll(N.bind(null,n,s,r,o));if(!f)return t({url:n,active:s,windowId:o?o.windowId:void 0,openerTabId:r.opener&&o?o.id:void 0,index:o?u(o,r.position):void 0},nn);hn(false,function(e){var r=e.state;return l({url:n,focused:s},"minimized"!==r&&"docked"!==r?r:"")})}function z(n){if(!(";".indexOf(n.substring(11).trim())>=0)){if(X){if(y(X,{N:5,u:n}))return;X=null}var e=function(e){if(-1===e||ln()){var r=Utils.Jo(n.substring(11));return chrome.tabs.executeScript({code:r},ln),ln()}};ChromeVer<71?chrome.tabs.update({url:n},e):e(-1)}}function E(e){var r,t,i,o=e[0],u=o.windowId,a=Q.urls,c=nn;for(r=0;r<a.length;r++)a[r]=Utils.Yo(a[r]+"");o.active=!(Q.reuse<-1),Q=null;do{for(r=0,t=o.index+1,i=o.active;r<a.length;r++,i=false,t++)n({url:a[r],index:t,windowId:u,active:i})}while(0<--c)}function $(e,r,t){var i,o,u=false;(t=t.filter(function(n){return"normal"===n.type})).length<=1?(u=true,(o=t[0])&&(o.id!==e.windowId?u=false:o.incognito&&!Utils.W(Settings.J.newTabUrl_f)&&(i=o.id))):e.incognito||1===(t=t.filter(function(n){return!n.incognito})).length&&t[0].id===e.windowId&&(i=t[0].id,u=true),u&&n({index:r.length,url:Settings.J.newTabUrl_f,windowId:i}),O(e,r,0,r.length)}function O(n,e,r,t){var i,o,u,a=chrome.tabs,c=n.index;a.remove(n.id,ln),i=e.slice(c+1,t),o=e.slice(r,c),nn<0&&(u=i,i=o,o=u),i.length>0&&a.remove(i.map(function(n){return n.id}),ln),o.length>0&&a.remove(o.map(function(n){return n.id}),ln)}function D(n,e){chrome.tabs.update(n,{active:true},e?A:null)}function A(n){return n&&chrome.windows.update(n.windowId,{focused:true}),ln()}function H(n,e,r){var t=n.index,i=false;e>0?r=r.slice(++t,t+e):(i=t>0&&r[0].pinned&&!r[t-1].pinned,e<0?r=r.slice(Math.max(t+e,0),t):r.splice(t,1)),i&&(r=r.filter(function(n){return!n.pinned})),r.length>0&&chrome.tabs.remove(r.map(function(n){return n.id}),ln)}function q(n,e,r){var t=n.a||{};r?r.postMessage({N:7,S:R(e),k:0,m:3}):t.$forced=true,(r||e).postMessage({N:10,S:null,c:n.c,n:n.n,a:t})}function L(n,e){if(on&&(clearTimeout(on),on=0),!e)return F(a.Lc[n],1,0,null);on=setTimeout(L,100,n,null),e[0].postMessage({N:13,c:n,i:on})}function F(n,e,r,t){var i,o,u,a,c=n.options,l=n.repeat;if(c&&(i=c.count)&&(e*=i),1===(e=e>=1e4?9999:e<=-1e4?-9999:0|e||1));else if(1===l)e=1;else{if(l>0&&(e>l||e<-l)&&!x(n.command,Math.abs(e)))return;e=e||1}if(n.background){if(a=gn[u=n.alias],Q=c||Object.create(null),X=t,nn=e,tn=r,(e=bn[u])<1)return a();1===e?fn(a):mn(a)}else t.postMessage({N:10,S:2367540>>(o=n.alias)&1?R(t):null,c:o,n:e,a:c})}function V(n,e){if(90!==n.H)return _n[n.H](n,e);e.postMessage({N:4,m:n.i,r:_n[n.c](n.a,e)})}function W(n,e){var r,t,i=Y(n),o=i.t,u=i.u,c=cn[o],l=u===Settings.J.vomnibarPage_f,s=0;if(e>=8||l){if(e<16||l){if(G(n,o,e))return;i.f=2}else s=(e>>>4&3)-1,i.f=(128&e?3:2)+(64&e&&4);n.postMessage({N:6,d:Settings.Xa})}else r=void 0,t=0,c&&1&(t=i.f=3&c[0].s.f)?r=2!==(s=c[0].s.s)?null:"":s=null===(r=Backend.Fc(u,i))?0:r?1:2,n.postMessage({N:0,s:t,c:Settings.Xa,p:r,m:a.Vc,k:a.Cu});i.s=s,n.sender.tab=null,n.onDisconnect.addListener(B),n.onMessage.addListener(V),c?(c.push(n),2&e&&(rn&&c[0].s.s!==s&&Backend.Wc(o,s),c[0]=n)):(cn[o]=[n,n],0!==s&&rn&&Backend.Wc(o,s)),sn&&(i.i=4&e?0:2+(9999997*Math.random()|0))}function B(n){var e,r=n.s.t,t=cn[r];t&&(e=t.lastIndexOf(n),n.s.i?(e===t.length-1?--t.length:e>=1&&t.splice(e,1),t.length<=1?delete cn[r]:n===t[0]&&(t[0]=t[1])):e>=0&&delete cn[r])}function G(n,e,r){if(r>=8){if(!w(n,false))return e<0&&(n.s.t=8!==r?en--:X?X.s.t:d.ho),yn.push(n),n.sender.tab=null,n.onDisconnect.addListener(K),n.onMessage.addListener(V),8===r&&n.postMessage({N:42,b:1,v:ChromeVer,o:Settings.J.vomnibarOptions,S:Settings.J.vc,s:an()}),true}else if(!(e<0||ChromeVer<50||0===n.s.i))return chrome.tabs.executeScript(e,{file:Settings.hn.Ec,frameId:n.s.i,runAt:"document_start"},ln),n.disconnect(),true;return false}function K(n){var e=yn,r=e.lastIndexOf(n);r===e.length-1?--e.length:r>=0&&e.splice(r,1)}function Y(n){var e=n.sender,r=e.tab||{id:en--,url:"",incognito:false};return n.s={i:e.frameId||0,a:r.incognito,s:0,f:0,t:r.id,u:e.url}}var J,Z,Q=null,X=null,nn=1,en=-4,rn=false,tn=0,on=0,un=-1,an=(J=0,Z=0,function(){var n=Date.now();return n-Z>3e3&&(J=1+(0|1879048191*Math.random())),Z=n,J}),cn=Object.create(null),ln=Utils.T,sn=ChromeVer<41,fn=chrome.tabs.query.bind(null,{active:true,currentWindow:true}),mn=chrome.tabs.query.bind(null,{currentWindow:true}),hn=function(n,e){var r=d.Bc;return r>=0?chrome.windows.get(r,{populate:n},e):chrome.windows.getCurrent({populate:n},e)},dn=ChromeVer>=52?null:[function(e){if(Q.url||Q.urls)return gn[14]([o(e.tabs)]);if(!e)return n({url:this}),ln();var r=o(e.tabs);return e.incognito&&"normal"!==e.type?dn[1](this,r,nn>1?function(n){for(var e=nn;0<--e;)chrome.tabs.duplicate(n)}:null,e.tabs):t({url:this,active:r.active,windowId:"normal"===e.type?r.windowId:void 0,index:u(r,Q.position)},nn)},function(n,e,r,t){var i,o=n.toLowerCase().split("#",1)[0];if(0!==(t=t.filter(function(n){var e=n.url.toLowerCase(),r=e.indexOf("#");return(r<0?e:e.substring(0,r))===o})).length)return i=t.filter(function(n){return n.index>=e.index}),e=i.length>0?i[0]:t[t.length-1],chrome.tabs.duplicate(e.id),r?r(e.id):void 0;chrome.windows.getAll(dn[2].bind(n,e,r))},function(n,e,r){return(r=r.filter(function(n){return!n.incognito&&"normal"===n.type})).length>0?dn[3](this,n,e,r[0]):s("about:blank",false,dn[3].bind(null,this,n,function(n,r){if(chrome.windows.remove(r),e)return e(n)}))},function(e,r,t,i){n({active:false,windowId:i.id,url:e},function(n){return s(n.id,true,function(){chrome.tabs.move(n.id,{index:r.index+1,windowId:r.windowId},function(){return t&&t(n.id,n.windowId),D(n.id)})})})}],pn=[function(e,r,t,i){var o,a,c,l=Settings.hn.zc;return!(!e.startsWith(l)||e.length<l.length+3)&&(i?(o=i.incognito,e=e.substring(l.length),Settings.Ya.Qa=(a=[e,null,0])[1]=function(){return clearTimeout(a[2]),Settings.Ya.Qa=null,a[0]},a[2]=setTimeout(pn[1],1200,a),0!==r||o?n({active:-2!==r,index:o?void 0:u(i,t.position),windowId:o?void 0:i.windowId,openerTabId:!o&&t.opener?i.id:void 0,url:l}):(c=!i.url.split("#",2)[1]&&ChromeVer>=54?chrome.extension.getViews({tabId:i.id}):[]).length>0&&c[0].onhashchange?c[0].onhashchange():chrome.tabs.update(i.id,{url:l}),true):(fn(function(n){if(!n||n.length<=0)return ln();pn[0](e,r,t,n[0])}),true))},function(n){n[0]="#!url vimium://error (vimium://show: sorry, the info has expired.)",n[2]=setTimeout(function(){Settings.Ya.Qa===n[1]&&(Settings.Ya.Qa=null),n[0]="",n[1]=null},2e3)}],vn=[function(n){if(2!==d.qc&&n&&(n=n.filter(function(n){return!n.incognito})),!(n&&n.length>0))return fn(vn[1].bind(this)),ln();hn(false,vn[2].bind(this,n))},function(e){var r=this.s?vn[3].bind(this,0):null;e.length<=0||2===d.qc&&!e[0].incognito?chrome.windows.create({url:this.u},r&&function(n){if(n.tabs&&n.tabs.length>0)return r(n.tabs[0])}):n({index:e[0].index+1,url:this.u,windowId:e[0].windowId},r)},function(n,e){var r,t=e.id,i=this.u,u=n.filter(function(n){return n.windowId===t});if(!(u.length<=0&&(u=e.incognito?n:n.filter(function(n){return!n.incognito})).length<=0))return this.p&&u.sort(function(n,e){return n.url.length-e.url.length}),(r=o(u)).url.length>u[0].url.length&&(r=u[0]),chrome.tabs.update(r.id,{url:r.url===i||r.url.startsWith(i)?void 0:i,active:true},this.s?vn[3].bind(this,0):null),r.windowId!==t?A(r):void 0;fn(vn[1].bind(this))},function(n,e){var r=this;return e?"complete"===e.status||n>=2?c.Gc(this,e):void setTimeout(function(){chrome.tabs.get(e.id,vn[3].bind(r,n+1))},800):ln()}],bn=[0,0,0,1,1,0,3,2,2,2,0,0,2,0,0,1,2,0,2,0,1,1,0,2,0,0,0,2,1,0,0,0,0,0,0,0,1,0,0,1],gn=[Utils.y,function(){function n(n){return t({url:n.url,active:false,windowId:n.windowId,pinned:n.pinned,index:n.index+2,openerTabId:n.id},nn-1)}var e=X.s.t;if(e<0)return Backend.Ac("duplicate such a tab");chrome.tabs.duplicate(e),nn<2||(ChromeVer>=52||0===d.qc||Settings.hn.Cc?chrome.tabs.get(e,n):chrome.windows.getCurrent({populate:true},function(r){var t,i=r.tabs.filter(function(n){return n.id===e})[0];if(!r.incognito||i.incognito)return n(i);for(t=nn;0<--t;)chrome.tabs.duplicate(e)}))},function(){function n(){return Backend.Oc("This tab has been in an incognito window")}var e=!!Q.incognito;if(e&&(X?X.s.a:2===d.qc))return n();chrome.windows.getCurrent({populate:true},e?function(e){var r,t,i=o(e.tabs);if(e.incognito&&i.incognito)return n();if(r={tabId:i.id,incognito:true},t=i.url,i.incognito);else{if(e.incognito)return Utils.W(t)?n():(++i.index,Backend.Kc(i));if(Utils.W(t)){if(ChromeVer>=52||Settings.hn.Cc)return Backend.Ac("open this URL in incognito mode")}else r.url=t}e.tabs=void 0,chrome.windows.getAll(function(n){var t,i;(n=n.filter(function(n){return n.incognito&&"normal"===n.type})).length?chrome.tabs.query({windowId:n[n.length-1].id,active:true},function(n){var e=n[0],t=r.tabId;r.url?(chrome.tabs.create({url:r.url,index:e.index+1,windowId:e.windowId}),A(e),chrome.tabs.remove(t)):s(t,true,function(){chrome.tabs.move(t,{index:e.index+1,windowId:e.windowId},function(){return D(t,true)})})}):(i="normal"===e.type?e.state:"",r.url&&(t=r.tabId,r.tabId=void 0,Settings.hn.Cc&&(r.focused=true,i="")),l(r,i),null!=t&&chrome.tabs.remove(t))})}:function(n){var e,r,t,i,u=n.tabs,a=u.length;if(!(a<=1)){if(e=o(u),(i=(t=S(r=e.index,a))[1]-t[0])>=a)return Backend.Oc("It does nothing to move all tabs of this window");if(!(i>30)||x("moveTabToNewWindow",i))return l({tabId:e.id,incognito:e.incognito},"normal"===n.type?n.state:"",i>1?function(e){var i,o,a,c,l=u[r],s=u.slice(r+1,t[1]),f=u.slice(t[0],r);n.incognito&&ChromeVer<52&&(i=l.incognito,s=s.filter(o=function(n){return n.incognito===i}),f=f.filter(o)),a=0,c=function(n){return n.id},f&&f.length>0&&(chrome.tabs.move(f.map(c),{index:0,windowId:e.id},ln),(a=f.length)>1&&chrome.tabs.move(l.id,{index:a})),s&&s.length>0&&chrome.tabs.move(s.map(c),{index:a+1,windowId:e.id},ln)}:null)}})},function(n){var e=n[0];chrome.windows.getAll(function(n){var r,t,i=e.windowId,o=n.filter(function(n){return n.incognito===e.incognito&&"normal"===n.type});if(o.length>0){if(r=o.map(function(n){return n.id}),i=r.indexOf(i),r.length>=2||i<0)return t=(i+nn)%r.length,i<0&&nn<0&&t++,t<0&&(t+=r.length),void chrome.tabs.query({windowId:r[t],active:true},function(n){function r(){chrome.tabs.move(e.id,{index:t.index+(Q.right>0?1:0),windowId:t.windowId},function(){return D(e.id,true)})}var t=n[0];i>=0||ChromeVer>=52?r():s(e.id,e.incognito,r)})}else o=n.filter(function(n){return n.id===i});return l({tabId:e.id,incognito:e.incognito},1===o.length&&"normal"===o[0].type?o[0].state:"")})},function(n){return v.Yc(nn,Q,n)},function(){return v.Jc(Q,X)},function(n){var e,r,t,i,u,a;if(!(n.length<2)){if(e=(0|Q.dir||1)*nn,r=n.length,(u=n[i=((i=Q.absolute?e>0?Math.min(r,e)-1:Math.max(0,r+e):Math.abs(e)>2*n.length?e>0?-1:0:(t=o(n)).index+e)>=0?0:r)+i%r]).pinned&&e<0&&Q.noPinned&&(a=(t||o(n)).index)>i&&!n[a-1].pinned){for(;n[i].pinned;)i++;u=n[i]}return u.active?void 0:D(u.id)}},function(n){var e,r,t,i,u,a,c,l;if(!n||n.length<=0)return ln();if(e=n.length,i=1,u=t=(r=o(n)).index,a=t+1,Math.abs(nn)>1&&e>1){if(c=0,n[0].pinned!==r.pinned&&!(nn<0&&n[t-1].pinned))for(;n[c].pinned;)c++;if((i=(a=c+(l=S(t,e-c,e))[1])-(u=c+l[0]))>20&&!x("removeTab",i))return}i>=e&&true!==Q.allow_close?chrome.windows.getAll($.bind(null,r,n)):(O(r,n,u,a),u>0&&Q.left&&chrome.tabs.update(n[u-1].id,{active:true}))},function(n){var e=0|Q.dir;return e=e>0?1:e<0?-1:0,H(o(n),e*nn,n)},function(n){if(n){var e=o(n).index,r=S(e,n.length,0,1),t=r[0],i=r[1];chrome.tabs.remove(n[e+1===i||nn>0&&t!==e?t:i-1].id)}},function(){var n,e;if(!chrome.sessions)return p();if((n=nn)<2&&n>-2&&X.s.a)return Backend.Oc("Can not restore a tab in incognito mode!");n>(e=0|chrome.sessions.MAX_SESSION_RESULTS)&&e>0&&(n=e);do{chrome.sessions.restore(null,ln)}while(0<--n)},function(){function n(n){if(nn>n.length)return Backend.Oc("The session index provided is out of range.");var e=n[nn-1],r=e.tab||e.window;r&&chrome.sessions.restore(r.sessionId)}return chrome.sessions?nn>(chrome.sessions.MAX_SESSION_RESULTS||25)?n([]):void(nn<=1?chrome.sessions.restore(null,ln):chrome.sessions.getRecentlyClosed(n)):p()},function(n){var e,r,t,i,u,a,c;if(ChromeVer<54&&Backend.Oc("Vimium C can not discard tabs before Chrome 54"),e=o(n).index,i=(r=Math.max(0,Math.min(e+nn,n.length-1)))>e?1:-1,!(!(t=Math.abs(r-e))||t>20&&!x("discardTab",t)))for((u=n[e+i]).discarded||chrome.tabs.discard(u.id,t>1?ln:function(){var n=ln();return n&&Backend.Oc("Can not discard the tab"),n}),a=2;a<=t;a++)(c=n[e+i*a]).discarded||chrome.tabs.discard(c.id,ln)},Utils.y,function(n){if(Q.urls)return Q.urls instanceof Array?n&&n.length>0?E(n):void fn(E):void(Q=null);if(Q.url_mask&&!n)return ln()||void fn(gn[14]);if(Q.url)M(Q.url+"",2,n);else if(Q.copied){var r=e.Zc();if(r instanceof Promise)return void r.then(P.bind(null,n),P.bind(null,null,null));P(n,r)}else M(Q.url_f||"",9,n)},function(n){var e,r=(Q.keyword||"")+"",t=Backend.ya({u:n[0].url});t&&r?(e=Utils.ta(t.u.split(" "),r,2),Q=Object.setPrototypeOf({reuse:0|Q.reuse,opener:true,url_f:e},null),gn[14](n)):Backend.Oc(r?"No search engine found!":'This key mapping lacks an arg "keyword"')},function(n){var e,r,t,i,u=o(n),a=!u.pinned,c={pinned:a},l=a?0:1,s=0;if(Math.abs(nn)>1&&a)for(;n[s].pinned;)s++;for(r=s+(e=S(u.index,n.length-s,n.length))[l]-l,t=s+e[1-l]-l,i=[];r!==t;r+=a?1:-1)(a||n[r].pinned)&&i.push(n[r].id);if(!((t=i.length)>30)||x("togglePinTab",t))for(r=0;r<t;r++)chrome.tabs.update(i[r],c)},function(){if(ChromeVer<45)return Backend.Oc("Vimium C can not control mute state before Chrome 45");Q.all||Q.other?chrome.tabs.query({audible:true},function(n){var e,r,t,i=Q.other?X.s.t:-1,o=-1===i?"All":"Other",u=false,a={muted:true};for(e=n.length;0<=--e;)(r=n[e]).id===i||r.mutedInfo.muted||(u=true,chrome.tabs.update(r.id,a));if(u)return Backend.Oc(o+" tabs get muted.");for(a.muted=false,e=n.length;0<=--e;)(t=n[e].id)!==i&&chrome.tabs.update(t,a);Backend.Oc(o+" tabs are unmuted.")}):fn(function(n){var e=n[0],r=!e.mutedInfo.muted;chrome.tabs.update(e.id,{muted:r}),Backend.Oc(r?"Muted.":"Unmuted.")})},function(n){var e,r,t,i,u,a;if(n.length<=0)hn(true,function(n){if(!n)return ln();n.tabs.length>0&&gn[18](n.tabs)});else if(e={bypassCache:true===(Q.hard||Q.bypassCache)},i=(t=S(r=o(n).index,n.length))[0],u=t[1],Q.single&&(i=r=r+1===u||nn>0&&i!==r?i:u-1,u=r+1),!((a=u-i)>20)||x("reloadTab",a))for(chrome.tabs.reload(n[r].id,e);i!==u;i++)i!==r&&chrome.tabs.reload(n[i].id,e)},function(){nn<2&&nn>-2?chrome.tabs.reload({bypassCache:true===(Q.hard||Q.bypassCache)}):mn(gn[18])},function(n){if(!(n.length<=0)){var e=n[0];if(++e.index,ChromeVer>=52||0===d.qc||Settings.hn.Cc||!Utils.W(e.url))return Backend.Kc(e);chrome.windows.get(e.windowId,function(n){return n.incognito&&!e.incognito&&(e.openerTabId=e.windowId=void 0),Backend.Kc(e)})}},function(n){var e=Q.trailing_slash,r=_n[3]({t:null!=e?!!e:null,u:n[0].url,p:nn}),t=r.u;if(null==r.p)return Backend.Oc(t);chrome.tabs.update(n[0].id,{url:t})},function(){var n=Q.trailing_slash;C({H:3,u:"",p:-nn,t:null!=n?!!n:null,e:true})},function(n){for(var e=o(n),r=Q.dir>0?1:-1,t=e.pinned,i=Math.max(0,Math.min(n.length-1,e.index+r*nn));t!==n[i].pinned;)i-=r;i!==e.index&&chrome.tabs.move(e.id,{index:i})},function(){var n,e,r=X,t=-1,i=cn[r.s.t];if(i&&i.length>2){for(t=Math.max(0,i.indexOf(r,1)),n=Math.abs(nn),e=nn>0?1:-1;n>0;n--)(t+=e)===i.length?t=1:t<1&&(t=i.length-1);r=i[t]}r.postMessage({N:7,S:0===r.s.i?R(r):null,k:tn,m:r!==X&&i&&r!==i[0]?2:1})},function(){var n=X?X.s.t:d.ho,e=k(n,0);e&&e.postMessage({N:7,S:R(e),k:tn,m:cn[n][0]===e?1:3})},function(){var n=X.s,e=sn?"Vimium C can not know parent frame before Chrome 41":n&&n.t>=0&&cn[n.t]?null:"Vimium C can not access frames in current tab";if(e&&Backend.Oc(e),!n||!n.i||sn||!chrome.webNavigation)return gn[25]();chrome.webNavigation.getAllFrames({tabId:n.t},function(e){var r,t,i,o,u,a=n.i,c=nn;do{for(r=false,t=0,i=e;t<i.length;t++)if((o=i[t]).frameId===a){r=(a=o.parentFrameId)>0;break}}while(r&&0<--c);if(!(u=a>0?k(n.t,a):null))return gn[25]();u.postMessage({N:7,S:R(u),k:tn,m:3})})},function(n){if(!(n.length<2)){n.splice(o(n).index,1);var e=(n=n.filter(function(n){return n.id in d.Qc}).sort(d.Xc))[nn>0?Math.min(nn,n.length)-1:Math.max(0,n.length+nn)];e&&D(e.id)}},function(n){var e,r=!!(Q.decoded||Q.decode);switch(Q.type){case"title":e=n[0].title;break;case"frame":if(rn&&(e=X.s.u))break;return void X.postMessage({N:10,S:R(X),c:18,n:1,a:{url:true,decoded:r}});default:e=n[0].url}return r&&(e=Utils.Jo(e,decodeURI)),Utils.wa(e),Backend.Oc(e,true)},function(){var n,e,r,t,i,o=Q.rel||Q.dir,u=[],a=Q.patterns;if(o=o?o+"":"next",a instanceof Array)for(n=0,e=a;n<e.length;n++)(r=(r=e[n])&&(r+"").trim())&&u.push(r.toLowerCase());else for("string"===typeof a||(a=""),t=0,i=a=(a=a||Settings.ic("next"!==o?"previousPatterns":"nextPatterns",true)).trim().toLowerCase().split(",");t<i.length;t++)(r=(r=i[t]).trim())&&u.push(r);u.length>200&&(u.length=200),X.postMessage({N:10,S:null,c:14,n:1,a:{rel:o,patterns:u}})},function(){var n,e=0|Q.code,r=0|Q.stat;e=0!==r?e||27:27===e?0:e,n=null!=Q.hideHUD?!Q.hideHUD:null!=Q.hideHud?!Q.hideHud:!Settings.ic("hideHud",true),X.postMessage({N:10,S:n?R(X):null,c:12,n:1,a:{code:e,stat:r,passExitKey:!!Q.passExitKey,hud:n}})},function(){var n,e,r;n=X.s.f,e="string"===typeof Q.mode?Q.mode.toLowerCase():"",r="",16&~n&&(r=Settings.hn.words,X.s.f=16|n),X.postMessage({N:10,S:R(X),c:8,n:1,a:{m:"caret"===e?3:"line"===e?2:1,w:r}})},function(){var n=X.s,e=nn<0?-nn:nn,r=Q.index,t=r?"other"===r?e+1:"count"===r?e:r>=0?-1-(0|r):0:0,i=!!t||!Q.active,o=null;32&n.f||(n.f|=32,o=Settings.J.pc),X.postMessage({N:10,S:R(X),c:1,n:1,a:{n:t>0?nn<0?-1:1:Q.dir<=0?-nn:nn,l:i,f:o,r:true===Q.returnToViewport,q:i||Q.last?b.Qi(n.a,"",t<0?-t:t):""}})},function(n){var e,r,t,i,o,u,a=X,c=Q.url;if(null!=c&&true!==c&&"string"!==typeof c&&(c=null,delete Q.url),a)0!==a.s.i&&a.s.t>=0&&!c&&(a=k(a.s.t,0)||a);else if(!(a=X=k(d.ho,0)))return;r=a.s.u,t=!(e=Settings.J.vomnibarPage_f).startsWith(f),i=n||!e.startsWith(location.origin)?Settings.hn.gc:e,o=(n=(t?r.startsWith(f)||e.startsWith("file:")&&!r.startsWith("file:")||e.startsWith("http:")&&r.startsWith("https:"):a.s.a)||r.startsWith(location.origin)||!!n)||e===i||a.s.t<0,u=Utils.g(Object.setPrototypeOf({v:o?i:e,i:o?null:i,t:o?0:t?2:1,s:o?"":Settings.hn.$c,k:an()},null),Q),a.postMessage({N:10,S:R(a),c:9,n:nn,a:u}),u.k=-1,Q=u},function(){var n=X.s.a;return b.nl(n),Backend.Oc((n?"incognito ":"")+"find history has been cleared.")},function(){if(0===X.s.i&&!(8&X.s.f))return _n[12]({},X);window.HelpDialog||Utils.ba("HelpDialog"),X.postMessage({N:10,S:null,c:17,n:1,a:null})},function(e){var r=e[0],t=r.url;if(t.startsWith(f))return Backend.Ac("visit HTML of an extension's page");n({url:t=t.startsWith("view-source:")?t.substring(12):"view-source:"+t,active:r.active,windowId:r.windowId,index:r.index+1,openerTabId:r.id})},function(){Q.local?C({H:18,u:"",a:2},true):c.el()},function(){var n=Settings.Xa,e=(Q.key||"")+"",r=n[e],t='"'+e+'"',i=Q.value,o="boolean"===typeof i,u="";Settings.kc.indexOf(e)<0?u=e in Settings.oc?"option "+t+" is not a valid switch":"unknown option "+t:"boolean"===typeof r?o||(i=null):void 0===i?u="need value=... for option "+t:o?u=t+" is not a boolean switch":typeof i!==typeof r&&(u="value of "+t+" should be like "+((u=JSON.stringify(r)).length>10?u.substring(0,9)+"\u2026":u)),u?Backend.Oc(u):X.postMessage({N:10,S:R(X),c:11,n:1,a:{key:e,value:i}})},function(n){var e,r,t,i,o,u,a=n[0].id,c=((Q.style||"")+"").trim(),l=!!Q.current;if(!c)return Backend.Oc("No style name of Vomnibar is given");for(e=0,r=yn;e<r.length;e++)if((t=r[e]).s.t===a)return void t.postMessage({N:46,t:c,c:l});l||_n[24]({s:(u=(i=Settings.J.vomnibarOptions).styles&&" "+i.styles+" ").indexOf(o=" "+c+" ")>=0?u.replace(o," "):u+c})}],wn=/^-?\d+|^-/,_n=[function(n,e){var r=n.key;if(!(r in Settings._c))return X=e,Backend.Ac("modify "+r+" setting");Settings.uc(r,n.value),r in Settings.Xa&&(Settings.Xa[r]=Settings.J[r])},function(n,e){return b.Qi(e.s.a,n.q,n.i)},function(n,e){var r=Backend.ya(n);if(!("i"in n))return r;e.postMessage({N:44,i:n.i,s:r})},function(n,e){var r,t,i,o,u,a,c,l,s,m,h,d,p,v,b,w,_;if(e&&n.e)return null!=(r=_n[3](n)).p?void e.postMessage({N:10,S:null,c:15,n:1,a:{url:r.u}}):(X=e,void Backend.Oc(r.u));if(i=(t=n.u).toLowerCase(),!Utils.qo.test(Utils.ia(i)))return Utils.C(),{u:"This url has no upper paths",p:null};if(o=encodeURIComponent,u="",l=false,s=false,m=null,d=0,p=0,v=false,(h=t.lastIndexOf("#")+1)&&(u=t.substring(h+ +("!"===t[h])),((h=(a=Utils.Jo(u)).lastIndexOf("/"))>0||0===h&&a.length>1)&&(v=a!==u,"/"===(m=(c=(w=/([^&=]+=)([^&\/=]*\/[^&]*)/).exec(a)||/(^|&)([^&\/=]*\/[^&=]*)(?:&|$)/.exec(a))?c[2]:a)||m.indexOf("://")>=0?m=null:c?v?(a="https://example.com/",a=encodeURI(a+m).substring(a.length),(h=u.indexOf(a))<0&&(h=u.indexOf(a=o(m))),h<0&&(v=false,h=u.indexOf(a=m)),p=h+a.length,h<0&&"&"!==c[1]&&((h=u.indexOf(a=c[1]))<0&&(v=true,a=o((a=c[1]).substring(0,a.length-1)),h=u.indexOf(a)),h>=0&&(p=u.indexOf("&",h+=a.length)+1)),h>=0?d=h:(b=w.exec(u))?(m=Utils.Jo(b[2]),p=(d=b.index+b[1].length)+b[2].length):"&"!==(a=c[1])&&(h=t.length-u.length,u=a+o(m),t=t.substring(0,h)+u,d=a.length,p=0)):d=c.index+c[1].length:d=0,m&&(d+=h=t.length-u.length,p>0&&(p+=h)))),!m){if(i.startsWith(f))return Utils.C(),{u:"An extension has no upper-level pages",p:null};u="",d=t.indexOf("/",t.indexOf("://")+3),i.startsWith("filesystem:")&&(d=t.indexOf("/",d+1)),h=t.indexOf("?",d),p=t.indexOf("#",d),m=t.substring(d,h=(h=p<0?h:h<0?p:h<p?h:p)>0?h:t.length),p=0,v=false}if(h=n.p,l=m.startsWith("/"),!u&&i.startsWith("file:")){if(m.length<=1||11===t.length&&t.endsWith(":/"))return Utils.C(),{u:"This has been the root path",p:null};s=true,1===h&&(h=-1)}else s=!(u||!i.startsWith("ftp:"))||(null!=n.t?!!n.t:m.length>1&&m.endsWith("/")||/\.([a-z]{2,3}|jpeg|tiff)$/i.test(m));return h&&1!==h?(_=m.substring(+l,m.length-+m.endsWith("/")||+l).split("/"),h<0&&(h+=_.length),h<=0?m="/":h>0&&h<_.length&&(_.length=h,m=(l?"/":"")+(m=_.join("/"))+(s?"/":""))):m="/",!p&&t.substring(0,d).indexOf("git")>0&&(m=g(t,m)||m),a=v?o(m):m,t=t.substring(0,d)+(p?a+t.substring(p):a),Utils.C(),{u:t,p:m}},function(n,r){function t(n){var e=null===n?"It's not allowed to read clipboard":(n=n.trim())?"":"No selected or copied text found";return e?(X=r,Backend.Oc(e)):m(n=Utils.ta(n.split(Utils.zo),o.k))}var i,o=Backend.ya(n);return o&&o.k?(i=n.s.trim()||(n.c?e.Zc():""))instanceof Promise?void i.then(t,function(){return t(null)}):t(i):(X=r,Backend.Oc("No search engine found!"))},function(n,e){var r,t=n.s,i=false!==n.a;if(X=I(e),"number"!==typeof t){if(!chrome.sessions)return p();if(chrome.sessions.restore(t,function(){var n=ln();return n&&Backend.Oc("The closed session may be too old."),n}),!i)return(r=e.s.t)>=0||(r=d.ho),r>=0?D(r):void 0}else chrome.tabs.update(t,{active:true},function(n){var e=ln();return e?Backend.Oc("The target tab has gone!"):A(n),e})},function(n,e){var r,t,i,o;return r=null!=e&&w(e,true),X=r?e:I(e)||X,t=n.u,(i=Object.create(null)).reuse=n.r,i.incognito=n.i,i.opener=false,t?(":"===t[0]&&n.o&&/^:[bdhostw]\s/.test(t)&&((t=t.substring(2).trim())||(r=false)),t=Utils.Ia(t),t=Utils.Yo(t,n.k||null,r?-1:2),o=Utils.Ko,null==n.h||2!==o&&1!==o?r&&3===o&&t.startsWith("vimium:")&&(t=Utils.Yo(t)):t=(n.h?"https":"http")+t.substring("s"===t[4]?5:4),n.u="",n.k="",i.url_f=t,i.opener=r&&!n.n):(i.copied=n.c,i.keyword=n.k),nn=1,Q=i,gn[14]()},function(n,e){var r,t=e.s.t,i=cn[t];return i?e!==i[0]?rn&&(r=e.s.s)!==i[0].s.s?(i[0]=e,Backend.Wc(t,r)):void(i[0]=e):void 0:rn?Backend.Wc(t,e.s.s):void 0},function(n,e){if(e||(e=k(n.tabId,n.frameId))){var r=e.s,t=r.u,i=Backend.Fc(r.u=n.url||n.u,r),o=null===i?0:i?1:2;if(r.s!==o){if(1&r.f)return;r.s=o,rn&&cn[r.t][0]===e&&Backend.Wc(r.t,o)}else if(!i||i===Backend.Fc(t,r))return;e.postMessage({N:1,p:i})}},function(n,e){var r,t;if(X=e,nn=1,tn=n.k,2!==(r=n.t||0))return gn[1===r?26:24]();(t=cn[e.s.t])?t[0].postMessage({N:7,k:tn,m:0}):y(e,{N:45,l:tn})},function(n,e){var r,t,i,o=cn[e.s.t];if(o&&(o[0].s.f|=2,!(o.length<3)))for(r={N:8},t=o.length;0<--t;)(i=o[t])!==e&&(i.postMessage(r),i.s.f|=2)},function(n,e){var r,t,i=cn[e.s.t],o=n.u;if(!i||i.length<3)return false;for(r=null,t=i.length;1<=--t;)if(i[t].s.u===o){if(r)return false;r=i[t]}return!!r&&(r.postMessage({N:10,S:R(r),c:n.c,n:n.n||1,a:n.a}),true)},function(n,e){e.s.u.startsWith(Settings.hn.jc)&&(n.t=true,n.b=true,n.n=true),Promise.all([Utils.ba("HelpDialog"),n,e,new Promise(function(n,e){var r=Settings.bc("helpDialog",n);r&&(r.onerror=e)})]).then(function(n){var e=n[1].w&&k(n[2].s.t,0)||n[2];e.s.f|=8,e.postMessage({N:14,S:R(e),h:n[0].rl(n[1]),o:Settings.hn.jc,a:Settings.ic("showAdvancedCommands",true)})},function(n){console.error("Promises for initHelp failed:",n[0],";",n[3])})},function(n,e){e.s.f|=6,e.postMessage({N:12,S:Settings.J.innerCSS})},function(n,e){var r=n.c,t=n.i;if(null!=r)delete n.c,delete n.H,delete n.i,nn=+r||1,Q=Object.setPrototypeOf(n,null);else{if(true!==n.r)return;if(null==Q||-1!==Q.secret){if(t)return;Q=Object.create(null),nn=1}else if(t&&Q.v===Settings.hn.gc)return}return X=e,gn[33](t)},function(n,e){if(!w(e,false))return r.tl(n.q,n,_.bind(e,0|n.i))},function(n){Utils.wa(n.d)},function(n,e){var r,t,i,o,u,c;return e.s.f|=2,t=1,null!=(i=wn.exec(r=n.k))&&(r=r.substring((o=i[0]).length),t="-"!==o?parseInt(o,10)||1:-1),r in(u=a.il)||(i=r.match(Utils.Ha),r=i[i.length-1],t=1),c=u[r],Utils.C(),F(c,t,n.l,e)},function(n,e){switch(X=e,n.a){case 1:return c.eo(n,e);case 0:return c.ol(n,e);case 2:return c.el(n.u);default:return}},function(n,e,r){var t,i=Utils.Ma(n.u.split("#",1)[0]),o=vn[0];i.startsWith("file:")&&!r&&i.substring(i.lastIndexOf("/")+1).indexOf(".")<0?(i+="/",t=function(e){return e&&e.length>0?o.call(n,e):_n[19](n,null,true)}):(n.p&&(i+="*"),t=o.bind(n)),chrome.tabs.query({url:i,windowType:"normal"},t)},function(n,e){var r=n.c,t=n.i;if(!(t>=-1&&on!==t))return on&&(clearTimeout(on),on=0),F(a.Lc[r],n.n,0,e)},function(n,e){return Backend.ul(n,e)},function(n,e){var r,t=n.u,i=Utils.aa(t);if(!i)return X=e,void Backend.Oc("The selected image URL is invalid");r=Settings.hn.zc+"#!image ",n.f&&(r+="download="+encodeURIComponent(n.f)+"&"),false!==n.a&&(r+="auto=once&"),pn[0](r+t,n.r,{opener:true})},function(n,e){var r=e.s.t,t=k(r,0);if(t||sn||!chrome.webNavigation)return q(n,e,t);chrome.webNavigation.getAllFrames({tabId:r},function(t){var i,o,u,a,c=e.s.i;for(o=0,u=t;o<u.length&&((a=u[o]).frameId!==c||!(i=(c=a.parentFrameId)>0&&k(r,c)));o++);q(n,e,i||null)})},function(n){var e,r=n.s.trim(),t=Settings.J.vomnibarOptions;r!==t.styles&&((e=Utils.g({},t)).styles=r,Settings.uc("vomnibarOptions",e))},function(n,e){Q=Object.setPrototypeOf({active:true,returnToViewport:true},null),X=e,nn=1,gn[32]()},ChromeVer>=72?function(n,e){var r,t,i=e.s.t,o=n.s,u=o>0?chrome.tabs.goForward:chrome.tabs.goBack;for(r=0,t=o>0?o:-o;r<t;r++)u(i,ln)}:Utils.y],yn=[];Backend={al:_n[5],ti:_n[6],cl:_n[8],fi:_n[19],Fc:Utils.Ba,ll:null,ul:function(n,e){var t=n.t,i=n.u,o="tab"===t?t:t+" item";return X=I(e),"tab"===t&&d.ho===+i?Backend.Oc("The current tab should be kept."):r.ul(i,t,function(n){return Backend.Oc(n?"Succeed to delete a "+o:"The "+o+" is not found!")})},Wc:function(){},Ac:function(n){return this.Oc("It's not allowed to "+n)},ya:function(n){var e,r,t,i,o,u=n.u,a=u.toLowerCase(),c=null,l=false;if(!Utils.qo.test(Utils.ia(a)))return Utils.C(),null;if(n.p)return null!=(t=_n[3](n)).p&&(u=t.u),{k:"",s:0,u:u};for(i=Settings.J.searchEngineRules,(r=Utils.Aa(a))&&(a=a.substring(r),u=u.substring(r)),r=i.length;0<=--r&&(!a.startsWith((e=i[r]).prefix)||!(c=u.substring(e.prefix.length).match(e.matcher))););if(!c||!e)return Utils.C(),null;for(c.length>1&&!e.matcher.global&&c.shift(),o=e.delimiter,c.length>1?l=true:o instanceof RegExp?(c=(a=c[0]).match(o))?(c.shift(),l=true):c=[a]:c=c[0].split(o),a="",r=0;r<c.length;r++)a+=" "+Utils.Jo(c[r]);return a=a.trim().replace(Utils.zo," "),Utils.C(),{k:e.name,u:a,s:l?a.lastIndexOf(" ")+1:0}},Kc:function(e,r){var t,i,o=e.id;if(r)return chrome.tabs.remove(o,ln),t=0,i=function(){var n=ln();if(n)return chrome.sessions.restore(),n;(t+=1)>=5||setTimeout(function(){chrome.tabs.get(o,i)},50*t*t)},void chrome.tabs.get(o,i);n({windowId:e.windowId,index:e.index,url:e.url,active:e.active,pinned:e.pinned,openerTabId:e.openerTabId}),chrome.tabs.remove(o)},Oc:function(n,e){X&&!y(X,{N:12,S:R(X),t:n,c:true===e})&&(X=null)},Dc:function(n,e){var r,t,i,o,u,a,c,l,s,f,m,h=cn[e||(e=d.ho)];if(h){if(n=n.toLowerCase(),r=null==Exclusions||Exclusions.Hc.length<=0,t=h[0].s.s,u=!((o=null!==(i="enable"===n?0:"disable"===n?2:"toggle"===n?0!==t?0:2:null))||r),a={N:1,p:2!==i?null:"",f:o},X=k(e,0)||h[0],!(null===i&&e<0)){for(l=o?i:0,s=h.length;1<=--s;)(m=(f=h[s]).s).f=o?1|m.f:-2&m.f,u&&1!==(l=null===(c=a.p=this.Fc(m.u,m))?0:c?1:2)&&m.s===l||(m.s=l,f.postMessage(a));return 2!==l&&this.Oc("Now the page status is "+(0===l?"enabled":"partially disabled")),rn&&(l=h[0].s.s)!==t?this.Wc(e,l):void 0}2!==t&&this.Oc("Got an unknown action on status: "+n)}},sl:function(n){var e=d.ho,r=cn[e];if("quickNext"===n&&(n="nextTab"),null==r||2&r[0].s.f||e<0)return L(n,r);r&&(r[0].s.f|=2),chrome.tabs.get(e,function(e){return L(n,e&&"complete"===e.status?cn[e.id]:null),ln()})},mc:function(n,e){return null==n?cn:null==e?-3===n?yn:cn[n]||null:k(n,e)},fl:function(){Backend.fl=null,Settings.sc("vomnibarOptions");var n=localStorage,e=n.getItem("styles");e&&(n.removeItem("styles"),_n[24]({s:e})),chrome.runtime.onConnect.addListener(function(n){return W(n,0|n.name.substring(9))}),chrome.runtime.onConnectExternal.addListener(function(n){var e,r=n.sender,t=n.name;if(r&&i(r.id,r.url)&&t.startsWith("vimium-c.")&&(e=t.split("@")).length>1){if(e[1]!==Settings.hn.GitVer)return n.postMessage({N:2,t:1}),void n.disconnect();W(n,0|e[0].substring(9))}else n.disconnect()})}},Settings.lc.newTabUrl_f=function(n){var e=Utils.W(n),r=e&&ChromeVer<52;gn[0]=r?function(){hn(true,dn[0].bind(n))}:j.bind(null,n,e),bn[0]=r?0:1},Settings.lc.showActionIcon=function(n){rn=n&&!!chrome.browserAction},chrome.runtime.onMessageExternal.addListener(function(n,e,r){var t,o,u,c,l;if(i(e.id,""))return"string"===typeof n?(t=n)&&a.Wa[t]?T(t,null,1,c=(u=(o=e.tab)?cn[o.id]:null)?k(o.id,e.frameId||0)||u[0]:null):void 0:void("object"===typeof n&&n&&(99===n.handler||91===n.handler?r({scripts:n.scripts?Settings.hn.Rc:null,version:Settings.hn.wc,host:"",versionHash:Settings.hn.GitVer}):"command"===n.handler&&(t=n.command?n.command+"":"")&&a.Wa[t]&&(c=(l=(o=e.tab)?cn[o.id]:null)?k(o.id,e.frameId||0)||l[0]:null,T(t,n.options,n.count,c,n.key))));r(false)}),Settings.sc("extWhiteList"),chrome.tabs.onReplaced.addListener(function(n,e){var r,t=cn,i=t[e];if(i)for(delete t[e],t[n]=i,r=i.length;0<--r;)i[r].s.t=n}),Settings.sc("vomnibarPage",null),Settings.sc("searchUrl",null),window.onunload=function(n){var e,r,t,i;if(!n||false!==n.isTrusted){for(r in(e=cn).omni=yn,e)for(i=(t=e[r]).length;0<--i;)t[i].disconnect();yn.length>0&&yn[0].disconnect()}}})();
